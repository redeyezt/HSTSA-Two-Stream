+ echo Logging output to ./logs/test_2022-08-09_15-09.log
Logging output to ./logs/test_2022-08-09_15-09.log
+ OUT_DIR=output/TZ/vgg16
+ case ${PHASE} in
+ CUDA_VISIBLE_DEVICES=3
+ python main.py --dataset dad --feature_name vgg16 --phase test --batch_size 10 --gpus 3 --visualize --output_dir output/TZ/vgg16 --model_file output/TZ/vgg16/dad/snapshot/final_model.pth
batch progress:   0%|          | 0/46 [00:00<?, ?it/s]batch progress:   2%|▏         | 1/46 [00:03<02:22,  3.17s/it]batch progress:   4%|▍         | 2/46 [00:06<02:20,  3.20s/it]batch progress:   7%|▋         | 3/46 [00:09<02:16,  3.18s/it]batch progress:   9%|▊         | 4/46 [00:12<02:12,  3.16s/it]batch progress:  11%|█         | 5/46 [00:15<02:09,  3.16s/it]batch progress:  13%|█▎        | 6/46 [00:18<02:05,  3.13s/it]batch progress:  15%|█▌        | 7/46 [00:22<02:02,  3.15s/it]batch progress:  17%|█▋        | 8/46 [00:25<02:00,  3.17s/it]batch progress:  20%|█▉        | 9/46 [00:28<01:55,  3.13s/it]batch progress:  22%|██▏       | 10/46 [00:31<01:51,  3.11s/it]batch progress:  24%|██▍       | 11/46 [00:34<01:48,  3.11s/it]batch progress:  26%|██▌       | 12/46 [00:37<01:45,  3.10s/it]batch progress:  28%|██▊       | 13/46 [00:40<01:42,  3.09s/it]batch progress:  30%|███       | 14/46 [00:43<01:40,  3.15s/it]batch progress:  33%|███▎      | 15/46 [00:47<01:37,  3.13s/it]batch progress:  35%|███▍      | 16/46 [00:50<01:34,  3.15s/it]batch progress:  37%|███▋      | 17/46 [00:53<01:31,  3.15s/it]batch progress:  39%|███▉      | 18/46 [00:56<01:27,  3.11s/it]batch progress:  41%|████▏     | 19/46 [00:59<01:24,  3.11s/it]batch progress:  43%|████▎     | 20/46 [01:02<01:20,  3.09s/it]batch progress:  46%|████▌     | 21/46 [01:05<01:17,  3.11s/it]batch progress:  48%|████▊     | 22/46 [01:08<01:14,  3.10s/it]batch progress:  50%|█████     | 23/46 [01:11<01:11,  3.12s/it]batch progress:  52%|█████▏    | 24/46 [01:15<01:08,  3.10s/it]batch progress:  54%|█████▍    | 25/46 [01:18<01:04,  3.09s/it]batch progress:  57%|█████▋    | 26/46 [01:21<01:01,  3.09s/it]batch progress:  59%|█████▊    | 27/46 [01:24<00:58,  3.09s/it]batch progress:  61%|██████    | 28/46 [01:27<00:56,  3.13s/it]batch progress:  63%|██████▎   | 29/46 [01:30<00:53,  3.14s/it]batch progress:  65%|██████▌   | 30/46 [01:33<00:50,  3.16s/it]batch progress:  67%|██████▋   | 31/46 [01:36<00:47,  3.15s/it]batch progress:  70%|██████▉   | 32/46 [01:40<00:44,  3.15s/it]batch progress:  72%|███████▏  | 33/46 [01:43<00:42,  3.30s/it]batch progress:  74%|███████▍  | 34/46 [01:46<00:39,  3.27s/it]batch progress:  76%|███████▌  | 35/46 [01:50<00:35,  3.25s/it]batch progress:  78%|███████▊  | 36/46 [01:53<00:32,  3.21s/it]batch progress:  80%|████████  | 37/46 [01:56<00:29,  3.23s/it]batch progress:  83%|████████▎ | 38/46 [01:59<00:25,  3.21s/it]batch progress:  85%|████████▍ | 39/46 [02:02<00:22,  3.18s/it]batch progress:  87%|████████▋ | 40/46 [02:06<00:19,  3.21s/it]batch progress:  89%|████████▉ | 41/46 [02:09<00:16,  3.20s/it]batch progress:  91%|█████████▏| 42/46 [02:12<00:12,  3.19s/it]batch progress:  93%|█████████▎| 43/46 [02:15<00:09,  3.19s/it]batch progress:  96%|█████████▌| 44/46 [02:18<00:06,  3.20s/it]batch progress:  98%|█████████▊| 45/46 [02:22<00:03,  3.20s/it]batch progress: 100%|██████████| 46/46 [02:25<00:00,  3.25s/it]batch progress: 100%|██████████| 46/46 [02:25<00:00,  3.16s/it]
Number of testing samples: 460
Focal_loss alpha = 0.25
=> loaded checkpoint 'output/TZ/vgg16/dad/snapshot/final_model.pth' (epoch 20)
video-level AP=0.86960
Average Precision= 0.8724, mean Time to accident= 3.1365
Precision at Recall 20: 1.0000
Recall@20%, Time to accident= 1.821
